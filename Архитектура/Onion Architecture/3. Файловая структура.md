В **Onion Architecture** каждый слой имеет свою четкую ответственность, и файловая структура отражает эту сегрегацию. Вот пример файловой структуры для типичного PHP-приложения, построенного по Onion Architecture. В этом примере использованы четыре основных слоя:

1. **Core (Domain Model)**: Здесь сосредоточена бизнес-логика, сущности, интерфейсы репозиториев и другие абстракции.
2. **Application**: Содержит бизнес-сервисы и координаторы, которые управляют выполнением операций с бизнес-логикой.
3. **Infrastructure**: Взаимодействует с внешними системами (база данных, API, очереди, системы отправки сообщений и т.д.).
4. **Presentation**: Веб-контроллеры, формы, представления и REST API для взаимодействия с пользователями и клиентами.

### Пример файловой структуры слоев Onion Architecture:

```
/src
├── Core
│   ├── Entity
│   │   └── User.php                     # Бизнес-сущность "User"
│   ├── Repository
│   │   └── UserRepositoryInterface.php   # Интерфейс репозитория пользователя
│   ├── Service
│   │   └── UserDomainService.php         # Бизнес-сервис для управления пользователями
│   └── ValueObject
│       └── Email.php                     # Объект-значение для email
│
├── Application
│   ├── Dto
│   │   └── RegisterUserDto.php           # DTO для передачи данных регистрации пользователя
│   ├── Service
│   │   └── RegisterUserService.php       # Сервис для регистрации пользователя
│   └── UseCase
│       └── RegisterUserUseCase.php       # (Опционально) Сценарий использования для регистрации
│
├── Infrastructure
│   ├── Persistence
│   │   └── DoctrineUserRepository.php    # Реализация репозитория пользователя через Doctrine
│   ├── Service
│   │   └── SmtpEmailSender.php           # Реализация сервиса отправки писем через SMTP
│   └── Migration
│       └── Version20231005000000.php     # Миграции базы данных
│
├── Presentation
│   ├── Controller
│   │   └── UserController.php            # Веб-контроллер для регистрации пользователя
│   ├── Form
│   │   └── RegisterUserFormType.php      # Форма для регистрации пользователя
│   ├── Template
│   │   └── user
│   │       └── register.html.twig        # Twig-шаблон для страницы регистрации
│   ├── Api
│   │   └── UserApiController.php         # Контроллер API для регистрации пользователя
│   └── Exception
│       └── ApiExceptionHandler.php       # Обработчик исключений для API
│
└── config
    └── services.yaml                     # Конфигурация контейнера зависимостей (DI)
```

### Разбор по слоям:

#### 1. **Core (Domain Model)**:
Это ядро системы, которое содержит сущности, объекты-значения (Value Objects), доменные сервисы и интерфейсы репозиториев. Этот слой независим от инфраструктуры и фреймворков.

- **Entity**: Содержит сущности (например, `User`), которые представляют бизнес-объекты и имеют поведение.
- **Repository**: Интерфейсы репозиториев для доступа к данным. Например, `UserRepositoryInterface`.
- **Service**: Содержит доменные (бизнес) сервисы, которые работают с сущностями и бизнес-логикой.
- **ValueObject**: Определяет объекты-значения, которые используются в бизнес-логике (например, `Email`).

#### 2. **Application**:
Здесь находятся бизнес-сценарии и сервисы, которые определяют логику использования приложения. Этот слой использует абстракции, определённые в Core.

- **Dto**: Data Transfer Objects (DTO) для передачи данных между слоями.
- **Service**: Сервисы уровня приложения, которые управляют выполнением бизнес-операций (например, регистрация пользователя).
- **UseCase**: (Опционально) Может содержать конкретные сценарии использования (Use Cases), которые координируют действия на основе определённых событий.

#### 3. **Infrastructure**:
Этот слой предоставляет конкретные реализации для интерфейсов репозиториев, сервисов и других внешних взаимодействий.

- **Persistence**: Взаимодействие с базой данных, включая реализацию репозиториев (например, через Doctrine ORM).
- **Service**: Реализация инфраструктурных сервисов (например, отправка email).
- **Migration**: Миграции базы данных.

#### 4. **Presentation**:
Слой, отвечающий за пользовательский интерфейс, веб-контроллеры и API.

- **Controller**: Веб-контроллеры для обработки HTTP-запросов, полученных от клиента.
- **Form**: Формы для сбора пользовательских данных.
- **Template**: Шаблоны для отображения веб-страниц.
- **Api**: Контроллеры для REST API.
- **Exception**: Обработчики исключений, которые перехватывают ошибки и формируют ответ клиенту.

### 5. **Config**:
Здесь хранятся конфигурационные файлы (например, для настройки DI-контейнера в Symfony). Это место, где связываются абстракции (интерфейсы) с их реализациями (классы инфраструктуры).

---

### Как это работает:
- **Core** и **Application** — это два слоя, которые независимы от фреймворков и инфраструктуры. Они содержат бизнес-логику и основные операции приложения.
- **Infrastructure** реализует зависимости для репозиториев и сервисов, необходимые для работы приложения, такие как базы данных или сторонние API.
- **Presentation** служит интерфейсом между пользователем и приложением. Он отправляет запросы в Application Layer и отображает результаты, используя шаблоны и API.

---

Эта структура помогает отделить бизнес-логику от технических деталей, таких как взаимодействие с базами данных, что делает систему более устойчивой к изменениям и легко тестируемой.