**Агрегатные функции** в SQL — это функции, которые выполняют вычисления над набором значений и возвращают одно значение. Эти функции часто применяются при группировке данных для получения сводной информации, такой как суммы, средние значения, минимальные и максимальные значения, количество строк и т.д.

### Основные агрегатные функции в SQL:

1. **COUNT()** — подсчитывает количество строк.
   - Возвращает количество строк, которые соответствуют условию.
   - Можно использовать для подсчета всех строк или только тех, которые содержат непустые значения в указанном столбце.

   #### Пример:
   ```sql
   SELECT COUNT(*) FROM employees;
   -- Подсчитает количество всех строк в таблице employees.
   
   SELECT COUNT(salary) FROM employees;
   -- Подсчитает количество непустых значений в столбце salary.
   ```

---

2. **SUM()** — суммирует значения.
   - Возвращает сумму значений столбца для выбранных строк. Обычно применяется к числовым данным.
   
   #### Пример:
   ```sql
   SELECT SUM(salary) FROM employees;
   -- Вычислит сумму всех зарплат сотрудников.
   ```

---

3. **AVG()** — вычисляет среднее значение.
   - Возвращает среднее арифметическое для набора числовых данных.
   
   #### Пример:
   ```sql
   SELECT AVG(salary) FROM employees;
   -- Вычислит среднюю зарплату сотрудников.
   ```

---

4. **MIN()** — возвращает минимальное значение.
   - Определяет минимальное значение в столбце. Работает как с числовыми данными, так и с датами, строками.
   
   #### Пример:
   ```sql
   SELECT MIN(salary) FROM employees;
   -- Вернёт минимальную зарплату среди сотрудников.
   
   SELECT MIN(hire_date) FROM employees;
   -- Вернёт самую раннюю дату найма.
   ```

---

5. **MAX()** — возвращает максимальное значение.
   - Определяет максимальное значение в столбце. Также работает с числами, датами, строками.
   
   #### Пример:
   ```sql
   SELECT MAX(salary) FROM employees;
   -- Вернёт максимальную зарплату среди сотрудников.
   
   SELECT MAX(hire_date) FROM employees;
   -- Вернёт самую позднюю дату найма.
   ```

---

6. **GROUP_CONCAT()** (в MySQL) / **STRING_AGG()** (в PostgreSQL) — объединяет строки в одну строку с разделителем.
   - Возвращает строку, содержащую значения из нескольких строк, разделенные указанным разделителем.
   
   #### Пример (MySQL):
   ```sql
   SELECT GROUP_CONCAT(name) FROM employees;
   -- Вернёт строку с именами всех сотрудников, разделёнными запятыми.
   ```

   #### Пример (PostgreSQL):
   ```sql
   SELECT STRING_AGG(name, ', ') FROM employees;
   -- Вернёт строку с именами всех сотрудников, разделёнными запятыми.
   ```

---

### Группировка с использованием агрегатных функций:

Агрегатные функции часто используются вместе с оператором **GROUP BY** для группировки данных по одному или нескольким столбцам.

#### Пример с группировкой:
```sql
SELECT department_id, AVG(salary)
FROM employees
GROUP BY department_id;
-- Выведет среднюю зарплату по каждому отделу.
```

В этом примере данные будут сгруппированы по отделам, и для каждого отдела будет вычислена средняя зарплата.

### Примечания:
- Агрегатные функции игнорируют значения **NULL** при вычислениях (например, при суммировании или подсчете строк).
- Агрегатные функции можно комбинировать в одном запросе для получения сводной информации по разным показателям (суммы, средние значения, количество).

#### Пример комбинированного запроса:
```sql
SELECT department_id, COUNT(*), AVG(salary), MIN(salary), MAX(salary)
FROM employees
GROUP BY department_id;
-- Выведет количество сотрудников, среднюю, минимальную и максимальную зарплаты по каждому отделу.
```

### Использование с условием **HAVING**:
**HAVING** позволяет фильтровать строки, которые проходят после группировки.

#### Пример:
```sql
SELECT department_id, AVG(salary)
FROM employees
GROUP BY department_id
HAVING AVG(salary) > 5000;
-- Выведет только те отделы, где средняя зарплата больше 5000.
```

Таким образом, агрегатные функции являются мощным инструментом для анализа данных, позволяя выполнять сводные операции и получать информацию, которая помогает принимать решения.