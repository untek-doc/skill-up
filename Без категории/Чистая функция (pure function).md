**Чистая функция (pure function)** — это функция, которая обладает следующими свойствами:

1. **Детерминированность (детерминизм):**  
    Для одних и тех же входных значений функция всегда возвращает один и тот же результат. Это означает, что результат зависит только от входных данных, и нет внешних факторов, влияющих на вычисления.
    
2. **Отсутствие побочных эффектов (side effects):**  
    Функция не изменяет состояние внешнего мира и не использует изменяемые данные извне. Она не изменяет глобальные переменные, не выполняет операции ввода-вывода (например, запись в файл или вывод в консоль) и не влияет на состояние переданных объектов.
    

---

### **Примеры чистых функций**

#### Пример 1: Чистая функция

```php
function add($a, $b) {
    return $a + $b;
}

echo add(2, 3); // Всегда вернет 5
```

- Результат зависит только от входных данных.
- Нет изменений внешнего состояния или побочных эффектов.

---

#### Пример 2: Функция с использованием неизменяемых данных

```php
function getSquares($numbers) {
    return array_map(fn($num) => $num ** 2, $numbers);
}

$result = getSquares([1, 2, 3]); // [1, 4, 9]
```

- Исходный массив `$numbers` не изменяется.
- Нет побочных эффектов, только возврат нового массива.

---

### **Примеры нечистых функций**

#### Пример 1: Использование глобальной переменной

```php
$global = 5;

function addToGlobal($a) {
    return $a + $global; // Использует внешнее состояние
}
```

- Зависит от значения глобальной переменной `$global`, что делает результат непредсказуемым, если `$global` изменится.

---

#### Пример 2: Изменение внешнего объекта

```php
function appendToArray(&$array, $value) {
    $array[] = $value; // Модифицирует переданный массив
}

$list = [1, 2, 3];
appendToArray($list, 4);

print_r($list); // [1, 2, 3, 4]
```

- Функция изменяет переданный массив, что нарушает принцип отсутствия побочных эффектов.

---

### **Преимущества чистых функций**

1. **Легкость тестирования:**  
    Чистые функции проще тестировать, так как они зависят только от входных данных. Их тесты не зависят от состояния системы или окружения.
    
2. **Прогнозируемость:**  
    Поведение функции легко предсказать, так как для одних и тех же входных данных она всегда возвращает один и тот же результат.
    
3. **Повышение читаемости:**  
    Поскольку чистая функция выполняет только одну задачу, она проще для понимания.
    
4. **Удобство в параллельных вычислениях:**  
    Чистые функции безопасны для выполнения в многопоточном режиме, так как не изменяют состояние.
    

---

### **Использование чистых функций в реальных проектах**

Чистые функции широко применяются в функциональном программировании, но они также полезны в других парадигмах, таких как объектно-ориентированное или процедурное программирование. Например:

- Валидация данных (проверка входных данных на корректность).
- Преобразование данных (например, фильтрация массива).
- Вычисления, не зависящие от внешнего состояния.

---

### **Пример из реальной жизни: PHP**

#### Чистая функция для валидации

```php
function isEven($number) {
    return $number % 2 === 0;
}

echo isEven(4); // true
echo isEven(5); // false
```

#### Преобразование данных

```php
function convertToUpperCase(array $strings) {
    return array_map(fn($str) => strtoupper($str), $strings);
}

$input = ['php', 'laravel', 'symfony'];
$output = convertToUpperCase($input); // ['PHP', 'LARAVEL', 'SYMFONY']
```

---

### **Ограничения чистых функций**

1. **Не всегда возможно избежать побочных эффектов:**  
    Например, запись данных в базу или отправка HTTP-запроса неизбежно связаны с побочными эффектами.
    
2. **Могут быть избыточными:**  
    Чистые функции иногда требуют копирования данных, что может быть менее эффективным, чем модификация.
    
3. **Не подходят для всех задач:**  
    Чистые функции не могут полностью заменить импаративный стиль программирования.
    

---

### **Когда использовать чистые функции**

- При написании вычислений, преобразований или логики, где важна предсказуемость.
- Для создания библиотек и утилит, которые должны быть переиспользуемыми и независимыми от окружения.
- В функциональном программировании для построения легко тестируемого и масштабируемого кода.

**Чистые функции — это строительные блоки надежного и предсказуемого кода.**