KDF (Key Derivation Function) — это функция преобразования ключа, используемая для генерации криптографических ключей из некоторого начального значения, например, пароля или мастер-ключа. Основная цель KDF — обеспечить безопасное преобразование исходного материала в ключ нужной длины для использования в криптографических алгоритмах. KDF также используется для усиления стойкости паролей, добавляя сложность к процессу их подбора.

### Основные задачи KDF
1. **Преобразование пароля в криптографический ключ**: KDF часто используется для создания ключей шифрования на основе паролей.
2. **Повышение стойкости к атакам перебором**: за счёт добавления случайных данных (соли) и применения множества итераций, KDF затрудняет расшифровку пароля путём простого подбора.
3. **Генерация ключей нужной длины**: например, если длина ключа симметричного алгоритма шифрования должна быть 256 бит, KDF может преобразовать менее устойчивый ключ в более длинный ключ фиксированной длины.

### Принципы работы KDF
KDF-функции часто используют методы, которые делают расчёт выходного ключа достаточно медленным и ресурсоёмким. Например, добавляются тысячи итераций хэширования и используется соль — случайные данные, добавляемые к исходному значению, что помогает предотвращать атаки с заранее вычисленными хэшами (rainbow tables).

### Популярные KDF-алгоритмы
1. **PBKDF2 (Password-Based Key Derivation Function 2)**:
   - Один из наиболее популярных KDF, определённый стандартом PKCS #5.
   - Применяет множество итераций хэширования (например, SHA-256) к паролю с добавлением соли.
   - Используется в большинстве современных приложений для хэширования паролей.

2. **bcrypt**:
   - Основан на алгоритме шифрования Blowfish и включает соль и итерации.
   - Использует адаптивный механизм, позволяющий увеличивать сложность с ростом вычислительных мощностей.
   - Подходит для хэширования паролей, устойчив к атакам перебором.

3. **scrypt**:
   - Разработан специально для того, чтобы требовать значительных ресурсов по времени и памяти.
   - Помимо итераций, использует значительные объёмы памяти, что делает его устойчивым к атакам с использованием специализированного оборудования (ASIC).
   - Часто используется для безопасного хранения паролей и в криптовалютных системах.

4. **Argon2**:
   - Современный KDF, победивший на конкурсе Password Hashing Competition (PHC) в 2015 году.
   - Обеспечивает настройку количества итераций, памяти и параллельных вычислений, что позволяет повысить устойчивость к аппаратным атакам.
   - Варианты Argon2i, Argon2d и Argon2id позволяют выбрать оптимальный способ защиты от различных типов атак.

### Применение KDF
KDF используется в различных сценариях, включая:
- **Хранение паролей**: хэширование паролей для защиты от утечек.
- **Генерация криптографических ключей**: для шифрования данных на основе пароля.
- **Криптографические протоколы**: используется для генерации ключей из мастер-ключей, например, в протоколах TLS и VPN.

### Преимущества использования KDF
- **Защита паролей**: KDF предотвращает простое хэширование паролей и затрудняет взлом.
- **Адаптивность**: возможность регулировать параметры для увеличения сложности с течением времени.
- **Универсальность**: подходит для создания ключей в разных криптографических сценариях.

KDF-функции стали стандартом для защиты данных и являются необходимым элементом в криптографии, где требуются надёжные ключи и повышенная устойчивость к атакам.