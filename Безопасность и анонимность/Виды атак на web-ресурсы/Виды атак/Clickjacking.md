**Clickjacking** (кликджекинг) — это тип атаки, при котором злоумышленник маскирует вредоносный элемент (например, кнопку или ссылку) под легитимный интерфейс на веб-странице. Пользователь, не подозревая о ловушке, кликает на скрытую кнопку или ссылку, что приводит к выполнению нежелательных действий.

### Механизм Clickjacking

Clickjacking работает через внедрение целевого веб-сайта в невидимый фрейм (iframe) на злоумышленной странице. Пользователь думает, что взаимодействует с обычной страницей, но на самом деле его действия направлены на выполнение вредоносных операций на другой странице.

Пример сценария атаки:
1. Злоумышленник загружает веб-страницу жертвы (например, страницу социальных сетей) в iframe на своем сайте.
2. Этот iframe делает страницу жертвы невидимой или частично прозрачной, и злоумышленник размещает элементы (кнопки, ссылки) поверх настоящих кнопок.
3. Пользователь нажимает на кнопку, не подозревая, что фактически взаимодействует с элементом на поддельной странице.

В результате жертва может непреднамеренно:
- Лайкнуть пост.
- Подписаться на пользователя.
- Перевести деньги.
- Изменить настройки аккаунта.

### Виды атак Clickjacking
- **Likejacking**: Злоумышленник заставляет пользователя случайно "лайкнуть" публикацию или страницу.
- **Cursorjacking**: Пользователю показывается один элемент, а реальный элемент, на который он нажимает, скрыт.
- **Фишинг через clickjacking**: Пользователь может быть перенаправлен на страницу для ввода конфиденциальных данных (паролей, банковской информации).

### Методы защиты от Clickjacking

1. **Заголовок HTTP `X-Frame-Options`**
   Этот заголовок позволяет серверу контролировать, может ли страница быть загружена во фрейм (iframe):
   - `DENY`: Запрещает загрузку страницы в любой iframe.
   - `SAMEORIGIN`: Разрешает загрузку только на страницах того же домена.
   - `ALLOW-FROM`: Разрешает загрузку страницы во фрейм с определённого источника.

   Пример:
   ```
   X-Frame-Options: DENY
   ```

2. **Content Security Policy (CSP)**
   Политика безопасности контента (CSP) позволяет управлять ресурсами, которые могут быть загружены на сайт. Для защиты от clickjacking можно использовать директиву `frame-ancestors`, которая ограничивает, какие сайты могут загружать вашу страницу в iframe.

   Пример:
   ```
   Content-Security-Policy: frame-ancestors 'self'
   ```

3. **JavaScript-защита**
   Можно использовать скрипты для проверки, загружается ли страница во фрейм. Если да — перенаправлять пользователя на другую страницу или блокировать доступ.

   Пример проверки:
   ```javascript
   if (window.top !== window.self) {
       window.top.location = window.self.location;
   }
   ```

4. **Ограничение iframe**
   Используйте минимальные возможности для загрузки своего контента во фреймы, если в этом нет необходимости. Особенно это важно для страниц, связанных с безопасностью, таких как формы авторизации или страницы с финансовой информацией.

5. **Информирование пользователей**
   В некоторых случаях можно информировать пользователей о том, что взаимодействие с ресурсом должно происходить только через определённые страницы и домены, чтобы снизить риск атак.

---

### Заключение

Clickjacking — это опасная и относительно простая атака, которая может привести к непреднамеренному выполнению пользователем действий, зачастую без его ведома. Защита от clickjacking требует использования комбинации серверных и клиентских мер, таких как заголовки безопасности, Content Security Policy и JavaScript.